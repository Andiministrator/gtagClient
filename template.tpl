___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "CLIENT",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "GTAG Client v1.1",
  "brand": {
    "id": "brand_dummy",
    "displayName": "Andiministrator",
    "thumbnail": "data:image/png;base64,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"
  },
  "description": "Deliver the GTAG Script with some nice features ...",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "CHECKBOX",
    "name": "debug",
    "checkboxText": "Debug Mode",
    "simpleValueType": true
  },
  {
    "type": "PARAM_TABLE",
    "name": "allowedIDs",
    "displayName": "GTAG Stream ID",
    "paramTableColumns": [
      {
        "param": {
          "type": "TEXT",
          "name": "id",
          "displayName": "GTAG Stream ID",
          "simpleValueType": true,
          "valueHint": "G-XXXXXXXX"
        },
        "isUnique": false
      }
    ],
    "help": "If no ID is specified, all GTAG Stream IDs are allowed"
  },
  {
    "type": "GROUP",
    "name": "gtagScript",
    "displayName": "Settings for GTAG script",
    "groupStyle": "ZIPPY_OPEN_ON_PARAM",
    "subParams": [
      {
        "type": "TEXT",
        "name": "timeout",
        "displayName": "Time Out for loading the GTAG script from Google (in ms)",
        "simpleValueType": true,
        "defaultValue": 5000
      },
      {
        "type": "CHECKBOX",
        "name": "nonDirectInject",
        "checkboxText": "Non Direct Injection of GTAG",
        "simpleValueType": true,
        "help": "Use a separate Script Tag for GTAG"
      },
      {
        "type": "PARAM_TABLE",
        "name": "scriptAttributes",
        "displayName": "Attributes for GTAG HTML Tag",
        "paramTableColumns": [
          {
            "param": {
              "type": "TEXT",
              "name": "stName",
              "displayName": "Name",
              "simpleValueType": true
            },
            "isUnique": false
          },
          {
            "param": {
              "type": "TEXT",
              "name": "stValue",
              "displayName": "Value",
              "simpleValueType": true,
              "help": "Use [id] as Placeholder for the GTAG Steam ID"
            },
            "isUnique": false
          }
        ],
        "help": "Attributes for \u0026lt;script\u0026gt; Tag, e.g. id\u003d\"GTAG\" will be: \u0026lt;script id\u003d\"GTAG\"\u0026gt;",
        "enablingConditions": [
          {
            "paramName": "nonDirectInject",
            "paramValue": true,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "oneTag",
        "checkboxText": "Avoid injecting GTAG, if another GTAG exists",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "nonDirectInject",
            "paramValue": true,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "GROUP",
        "name": "addJSCode",
        "displayName": "Add additional JS Code to the GTAG Script",
        "groupStyle": "ZIPPY_OPEN_ON_PARAM",
        "subParams": [
          {
            "type": "TEXT",
            "name": "addJSbeforeGTAG",
            "displayName": "JS Code before the GTAG script",
            "simpleValueType": true
          },
          {
            "type": "TEXT",
            "name": "addJSafterGTM",
            "displayName": "JS Code after the GTAG script",
            "simpleValueType": true
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "otherSettings",
    "displayName": "Additional Settings",
    "groupStyle": "ZIPPY_OPEN_ON_PARAM",
    "subParams": [
      {
        "type": "CHECKBOX",
        "name": "fireDLevent",
        "checkboxText": "Fire a dataLayer Control Event",
        "simpleValueType": true,
        "help": "A control dataLayer event (named \"gtag_loaded\") will be fired with the GTAG ID as (\"gtag\") parameter."
      },
      {
        "type": "SELECT",
        "name": "timeDLevent",
        "displayName": "When should the dataLayer Event be fired?",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": "fireDLbefore",
            "displayValue": "Before the GTAG integration"
          },
          {
            "value": "fireDLafter",
            "displayValue": "After the GTAG integration"
          }
        ],
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "fireDLevent",
            "paramValue": true,
            "type": "EQUALS"
          }
        ],
        "defaultValue": "fireDLafter"
      }
    ]
  }
]


___SANDBOXED_JS_FOR_SERVER___

/*** GTAG Client | BOF ***/

/**
 * Global implementation script for delivering a GTAG.
 * @version 1.1
 * @lastupdate 11.09.2025 by Andi Petzoldt <andi@petzoldt.net>
 * @repository https://github.com/Andiministrator/gtagClient/
 * @author Andi Petzoldt <andi@petzoldt.net>
 * @documentation see README.md or https://github.com/Andiministrator/gtagClient/
 * @sGTMdocumentation https://developers.google.com/tag-platform/tag-manager/server-side/api?hl=de
 */

// Initialization
const claimRequest = require('claimRequest');
const getGoogleScript = require('getGoogleScript');
const getRequestPath = require('getRequestPath');
const getRequestQueryParameter = require('getRequestQueryParameter');
const setResponseBody = require('setResponseBody');
const setResponseHeader = require('setResponseHeader');
const setResponseStatus = require('setResponseStatus');
const returnResponse = require('returnResponse');
const toBase64 = require('toBase64');
const makeNumber = require('makeNumber');
const createRegex = require('createRegex');
const logToConsole = require('logToConsole');

// Config
var CONFIG = {
  debug: typeof data.debug=='boolean' ? data.debug : false,
  timeout: makeNumber(data.timeout ? data.timeout : 5000),
  nonDirectInject: typeof data.nonDirectInject=='boolean' ? data.nonDirectInject : false,
  addJSbeforeGTM: typeof data.addJSbeforeGTM=='string' ? data.addJSbeforeGTM : '',
  addJSafterGTM: typeof data.addJSafterGTM=='string' ? data.addJSafterGTM : '',
  fireDLevent: typeof data.fireDLevent=='boolean' ? data.fireDLevent : false,
  timeDLevent: typeof data.timeDLevent=='string' ? data.timeDLevent : '',
  oneTag: typeof data.oneTag=='boolean' ? data.oneTag : false,
  stAttributes: data.scriptAttributes || [],
  allowedIDs: data.allowedIDs || []
};

// Get data
var debugMode = getRequestQueryParameter('debug') === 'true' || CONFIG.debug;
var requestedId = getRequestQueryParameter('id');

// Check if Request is to claim
if (getRequestPath() !== '/gtag/js' || !requestedId) return;
var allowed = false;
if (CONFIG.allowedIDs && CONFIG.allowedIDs.length>0) {
  for (var j=0; j<CONFIG.allowedIDs.length; j++) {
    if (requestedId==CONFIG.allowedIDs[j].id) allowed = true;
  }
} else { allowed = true; }
if (!allowed) return;
claimRequest();

// Some Debug info
if (CONFIG.debug) {
  logToConsole('info', '=== GTAG Client ===', CONFIG.nonDirectInject ? '(own script tag)' : '(direct)');
  logToConsole('info', 'Requested ID:', requestedId);
  logToConsole('info', 'Debug Mode:', debugMode);
}

// Help Functions

// Get GTAG script for first ID
const rgx = createRegex('\\[id\\]', 'i');
var fireScript = function(src) {
  if (typeof src!='string') src = '';
  src += ';\n';
  // Set additional dataLayer event
  if (CONFIG.fireDLevent) {
    var dl_ev_src = '\nwindow.dataLayer=window.dataLayer||[];\n' + 'window.dataLayer.push({ event:"gtag_loaded", gtag:"'+requestedId+'" });\n';
    if (CONFIG.timeDLevent == 'fireDLbefore') { src = dl_ev_src + src; } else { src += dl_ev_src; }
  }
  src = CONFIG.addJSbeforeGTM + src + CONFIG.addJSafterGTM;
  if (!CONFIG.nonDirectInject) return src;
  var ret = '(function(){\n';
  if (CONFIG.oneTag) ret+= 'var exists=document.querySelector(\'script[data-src-flag="gt"]\');if(!exists){\n';
  ret += 'var s=document.createElement("script");s.type="text/javascript";s.setAttribute("data-src-flag","gt");';
  for (var i=0; i<CONFIG.stAttributes.length; i++) {
    var nam = CONFIG.stAttributes[i].stName;
    var val = CONFIG.stAttributes[i].stValue;
    if (val.indexOf('id')!==-1) val = val.replace(rgx, requestedId);
    ret += nam=='id' ? 's["'+nam+'"]="'+val+'";'
                     : 's.setAttribute("'+nam+'","'+val+'");';
  }
  ret += 's.text=atob("' + toBase64(src) + '");document.head.appendChild(s);\n';
  if (CONFIG.oneTag) ret += '}\n';
  ret += '})();\n';
  return ret;
};

// Set Header
var setHeader = function(headers) {
  if (typeof headers!='object' || !headers) headers = {};
  setResponseHeader('Content-Type', headers['content-type'] || 'application/javascript; charset=utf-8');
  setResponseHeader('Cache-Control', headers['cache-control'] || 'public, max-age=3600');
  setResponseHeader('Access-Control-Allow-Origin', '*');
  setResponseHeader('Access-Control-Allow-Methods', 'GET');
  if (headers.expires) setResponseHeader('Expires', headers.expires);
  if (headers['last-modified']) setResponseHeader('Last-Modified', headers['last-modified']);
};

// Send Error
var sendError = function(errmsg, obj) {
  if (CONFIG.debug) logToConsole('warn', '✗ '+errmsg, obj);
  setHeader(null);
  setResponseStatus(500);
  setResponseBody('/* ' + errmsg + '*/');
  returnResponse();
};

// Send Response
var sendResponse = function(header,src) {
  if (typeof src!='string' || !src) {
    sendError('No GTAG available', typeof src);
    return;
  }
  setHeader(header);
  setResponseStatus(200);
  setResponseBody(src);
  returnResponse();
};

// Main Logic
getGoogleScript('GTAG', {
  id: requestedId,
  debug: debugMode,
  timeout: CONFIG.timeout
}).then(function(result) {
  if (CONFIG.debug) logToConsole('info', '✓ GTAG Script geladen:', requestedId);
  sendResponse(result.header, fireScript(result.script));
}).catch(function(error) {
  sendError('Error by loading GTAG script (ID: '+requestedId+')', error);
});

/*** GTAG Client | EOF ***/


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "access_response",
        "versionId": "1"
      },
      "param": [
        {
          "key": "writeResponseAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "writeHeaderAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_request",
        "versionId": "1"
      },
      "param": [
        {
          "key": "requestAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "headerAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queryParameterAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_http",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "return_response",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Check JS Code
  code: |
    // Set Mocks
    //mock('setResponseStatus', 200);
    //mock('setResponseHeader', '1.2.2');
    //mock('setResponseBody', 'console.log("aGTM");');
    //mock('returnResponse');

    // Run Code
    runCode(mockData);

    // Checks
    //assertApi('setResponseStatus').wasCalledWith(200);
    //assertApi('setResponseHeader').wasCalled();
    //assertApi('setResponseBody').wasCalled();
    //assertApi('returnResponse').wasCalled();
setup: |-
  // Import needed libraries
  const log = require('logToConsole');

  // Setup MockData
  const mockData = {
    gtm: {
      gtm_id: 'GTM-XYZ123',
      gtm_consent: true,
      gtm_env: ''
    },
    cmp: null,
    consent: {
      gtmPurposes: 'Functional',
      gtmServices: 'Google Tag Manager',
      gtmVendors: 'Google Inc'
    },
    sendConsentEvent: true,
    useListener: false,
    consent_events: 'cmpEvent,cmpUpdate',
    vPageview: false,
    dlStateEvents: false,
    gdl: '',
    nonce: 'ABC123',
    debug: true
  };


___NOTES___

# Serverside GTM Client Template for a GTAG Client

This is the Client Template to use it with the serverside Google Tag Manager.
It integrates a GTAG (script) in a website. You can set different options.

## Google Documentation for GTAG

- [Google Tag API-Referenz](https://developers.google.com/tag-platform/gtagjs/reference?hl=de)
- [Parameterreferenz des Google-Tags (gtag.js)](https://developers.google.com/tag-platform/gtagjs/reference/parameters?hl=de)
- [GTAG Events und deren Parameter](https://developers.google.com/analytics/devguides/collection/ga4/reference/events?hl=de&client_type=gtag)


